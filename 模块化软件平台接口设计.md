#  模块化软件平台接口设计

## 模块化软件平台架构设计

模块化软件平台架构的设计如下图所示，整个软件平台主要分为1. CPU外设驱动层，2. 通用模块层，3. 功能逻辑层，4. 公共服务库。

### 1. CPU外设驱动层

该层包括所有可能需要用到的外设的驱动实现，为上层提供硬件驱动接口。该层与硬件架构密切相关，考虑到我们目前主要用到TI的C2000DSP系列和STM32系列两种硬件架构，因此CPU驱动层也会按照这两种硬件架构分为两个软件包，虽然不同硬件平台的驱动实现不同，但是为了上层程序的复用性考虑，应尽量保证驱动调用的接口一致。此外STM32提供的标准外设库比较完备，需要重新编码的工作较少。

### 2. 通用模块层

该层模块包括所有在项目中可能会用到的具体的功能模块的软件实现。例如不同流量传感器模块，比例阀控制模块，IP阀控制模块，涡轮控制模块，氧传感器模块等。这一层的软件代码应该尽最大可能做到通用和易移植。

### 3. 功能逻辑层

这一层的软件负责调用不同的模块以实现项目中会用到的一些具体的功能逻辑，如报警模块，不同的通气模式实现，通气参数监测功能，气道参数计算功能，通讯协议实现，自建功能实现等。

### 4. 公共服务库

公共服务库部分提供一些通用的数据结构和功能模块实现，这部分代码与任何项目解耦，可以直接被移植和调用。例如PI控制器，数字滤波器，限幅器，循环队列，栈，链表等。



![image-20210504171239581](模块化软件平台接口设计.assets/image-20210504171239581.png)

## 驱动层接口设计



## 通用服务层接口设计



## 通用模块层接口设计



## 功能逻辑层接口设计



